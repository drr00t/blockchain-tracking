<!DOCTYPE html>
<html>
  <head>
    <title>Tracking</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">

    <script language="javascript" type="text/javascript" src="js/web3.min.js"></script>
    <script language="javascript" type="text/javascript" src="contracts/contract_abi.js"></script>
    
    <script language="javascript" type="text/javascript" src="js/ui.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-" crossorigin="anonymous">
    <link rel="stylesheet" href="css/layouts/side-menu.css">
    
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    
    <!-- Side Bar -->
    <div id="layout">
        <a href="#menu" id="menuLink" class="menu-link">
            <span></span>
        </a>
        <div id="menu">
            <div class="pure-menu">
                <a class="pure-menu-heading" href="#">Eldorado</a>
                <ul class="pure-menu-list">
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Home</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">About</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Services</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Contact</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Maps -->
    <div id="map"></div>

    <script>
        var citymap = {
            lagoSul: {
                center: {lat: -15.83684779, lng: -47.87309647},
            },
            guara: {
                center: {lat: -15.84015068, lng: -47.97437668},
            },
            asaNorte: {
                center: {lat: -15.76251863, lng: -47.88236618},
            },
            lagoNorte: {
                center: {lat: -15.7512843, lng: -47.8404808},
            }
        };
        
        var map;
        
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: -15.82132351, lng: -47.92991638},
                zoom: 12,
                mapTypeId: 'roadmap'
            });

            for (var city in citymap) {
                var cityCircle = new google.maps.Circle({
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35,
                    map: map,
                    center: citymap[city].center,
                    radius: Math.sqrt(50) * 100
                });
            }
        }
    </script>
    
    <script>
        var contract;

        window.addEventListener('load', function() {
            var web3js;
            if (window.web3) {
                web3js = window.web3;
                console.log("Injected web3")
            } else {
                var web3js = window.web3;
                // const provider = new Web3(new PortisProvider({
                //     apiKey: process.env.REACT_APP_PORTIS,
                //     providerNodeUrl: "http://localhost:7545"
                // }));
                // var web3js = new Web3(provider);
                // console.log("No web3 instance injected, using Local web3.");
            }
            console.log(web3js)

            // Agora vocÃª pode iniciar seu aplicativo e acessar o web3js livremente:
            startApp(web3js)
        })

        function startApp() {
            const contractAddress = "0x345ca3e014aaf5dca488057592ee47305d9b3e10";

            // contractABI is at contracts/contract_abi.js
            contract = new web3js.eth.Contract(contractABI, contractAddress);
            console.log(contract.address) 
        }
    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDNyIL_vOhOYdSZc-hODAlGVoUpLJYf7fA&callback=initMap"
    async defer></script>
  </body>
</html>